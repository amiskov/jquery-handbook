<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Основы jQuery | 10. Talk to the server with Ajax</title>
    <meta name="description" content="">
    
    
    <link rel="preload" href="/jquery-handbook/assets/css/10.styles.27f07c85.css" as="style"><link rel="preload" href="/jquery-handbook/assets/js/app.c2cea729.js" as="script"><link rel="preload" href="/jquery-handbook/assets/js/3.b1b10936.js" as="script"><link rel="prefetch" href="/jquery-handbook/assets/js/5.538054b4.js"><link rel="prefetch" href="/jquery-handbook/assets/js/0.10c57b0b.js"><link rel="prefetch" href="/jquery-handbook/assets/js/1.b1313eb9.js"><link rel="prefetch" href="/jquery-handbook/assets/js/2.24c05937.js"><link rel="prefetch" href="/jquery-handbook/assets/js/4.dca42521.js"><link rel="prefetch" href="/jquery-handbook/assets/js/6.19b687bd.js"><link rel="prefetch" href="/jquery-handbook/assets/js/7.8f8aa961.js"><link rel="prefetch" href="/jquery-handbook/assets/js/8.dc86523a.js"><link rel="prefetch" href="/jquery-handbook/assets/js/9.1bb06ecd.js">
    <link rel="stylesheet" href="/jquery-handbook/assets/css/10.styles.27f07c85.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div><a href="/jquery-handbook/" class="home-link router-link-active"><!----><span class="site-name">
      Основы jQuery
    </span></a><div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""><!----></div><!----></div></header><div class="sidebar-mask"></div><div class="sidebar"><!----><ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading open"><span>DOM</span><!----></p><ul class="sidebar-group-items"><li><a href="/jquery-handbook/ch01/" class="sidebar-link">1. Introducing jQuery</a></li><li><a href="/jquery-handbook/ch02/" class="sidebar-link">2. Selecting elements</a></li><li><a href="/jquery-handbook/ch03/" class="sidebar-link">3. Operating on a jQuery collection</a></li><li><a href="/jquery-handbook/ch04/" class="sidebar-link">4. Working with properties, attributes, and data</a></li><li><a href="/jquery-handbook/ch05/" class="sidebar-link">5 Bringing pages to life with jQuery</a></li><li><a href="/jquery-handbook/ch10/" class="active sidebar-link">10. Talk to the server with Ajax</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/jquery-handbook/ch10/#_10-1-brushing-up-on-ajax" class="sidebar-link">10.1 Brushing up on Ajax</a></li><li class="sidebar-sub-header"><a href="/jquery-handbook/ch10/#_10-2-loading-content-into-elements" class="sidebar-link">10.2 Loading content into elements</a></li><li class="sidebar-sub-header"><a href="/jquery-handbook/ch10/#_10-3-making-get-and-post-requests" class="sidebar-link">10.3 Making GET and POST requests</a></li><li class="sidebar-sub-header"><a href="/jquery-handbook/ch10/#_10-4-taking-full-control-of-an-ajax-request" class="sidebar-link">10.4 Taking full control of an Ajax request</a></li><li class="sidebar-sub-header"><a href="/jquery-handbook/ch10/#вопросы-и-задания" class="sidebar-link">Вопросы и задания</a></li></ul></li><li><a href="/jquery-handbook/ch11/" class="sidebar-link">11 Demo: an Ajax-powered contact form</a></li><li><a href="/jquery-handbook/ch13/" class="sidebar-link">13 Avoiding the callback hell with Deferred</a></li></ul></div></li></ul></div><div class="page"><div class="content"><h1 id="_10-talk-to-the-server-with-ajax"><a href="#_10-talk-to-the-server-with-ajax" aria-hidden="true" class="header-anchor">#</a> 10. Talk to the server with Ajax</h1><ul><li>A brief overview of Ajax</li><li>Loading preformatted HTML from the server   Making GET and POST requests</li><li>Exerting fine-grained control over requests</li><li>Setting default Ajax properties</li><li>Handling Ajax events</li></ul><div class="warning custom-block"><p class="custom-block-title">Синтаксис</p><p>В коде проектов используйте полный синтаксис <a href="https://learn.jquery.com/ajax/jquery-ajax-methods/" target="_blank" rel="noopener noreferrer"><code>$.ajax</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> вместо сокращений <code>$.get()</code>, <code>$.post()</code> и <code>.load()</code> пр. Во-первых, код будет однообразный, во-вторых удобно изменять/добавлять свойства и методы и в третьих, практически всегда сокращений не достаточно для определения всех параметров запроса.</p></div><p>Термин Ajax (for Asynchronous JavaScript and XML) предложил Jesse James Garrett из Adaptive Path в 2005-м году.</p><h2 id="_10-1-brushing-up-on-ajax"><a href="#_10-1-brushing-up-on-ajax" aria-hidden="true" class="header-anchor">#</a> 10.1 Brushing up on Ajax</h2><p>Аяксовый запрос использует конструктор <code>XMLHttpRequest</code> (XHR) или Microsoft XMLHTTP ActiveX control под капотом. Такие запросы позволяют отправлять и получать информацию с сервера без перезагрузки страницы.</p><p><img src="/jquery-handbook/assets/img/ajax_scheme.aef4ceed.png" alt></p><p>Спецификация XHR: https://xhr.spec.whatwg.org</p><p>Перед тем, как послать запрос, нужно сделать вот что:</p><ol><li>Specify the HTTP method (such as POST or GET).</li><li>Provide the URL of the server-side resource to be contacted.</li><li>Let the XHR instance know how it can inform you of its progress.</li><li>Provide any body content for requests such as POST.</li></ol><p>Хоть в Ajax буква 'X' значит XML, ответ может быть в любом формате: текст, HTML, JSON, XML, ...</p><p>Нативный аякс требует:</p><ul><li>Специфического кода для старых браузеров</li><li>Нужно отсеивать стейты запроса</li><li>Нужно обрабатывать ответ в соответствии с его MIME-типом</li></ul><h2 id="_10-2-loading-content-into-elements"><a href="#_10-2-loading-content-into-elements" aria-hidden="true" class="header-anchor">#</a> 10.2 Loading content into elements</h2><h3 id="_10-2-1-loading-content-with-jquery"><a href="#_10-2-1-loading-content-with-jquery" aria-hidden="true" class="header-anchor">#</a> 10.2.1 Loading content with jQuery</h3><p>Загрузить кусок HTML с сервера в див можно методом <a href="http://api.jquery.com/load/" target="_blank" rel="noopener noreferrer"><code>load</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>:</p><div class="language-js extra-class"><pre class="language-js"><code><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#elem'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span><span class="token string">'some-resource'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><code>load</code> вернет коллекцию, можно чейнить (сработает сразу, не будет дожидаться ответа, см. <code>load_chaining.html</code>).</p><p><code>load(url[, data][, callback])</code> — если <code>data</code> задана объектом, то пошлется POST. Если на задать, будет GET. Если надо задать параметры и послать GET, нужно его декодировать в строку (использовать <code>$.param</code> или <code>encodeURIComponent()</code>)</p><p>В колбэк приходит 3 параметр: <code>responseText, status, jqXHR</code>. <code>jqXHR</code> — расширенный объект XHR (jQuery добавляет свои методы и свойства). Например, можно взять контент-тайп: <code>jqXHR.getResponseHeader('Content-Type')</code>.</p><p>Можно даже делать так: <code>.load('data.html p:last-of-type', loadCb)</code>. Вставится только последний из абзацев.</p><h4 id="сериаnизация-десериаnизация-форм"><a href="#сериаnизация-десериаnизация-форм" aria-hidden="true" class="header-anchor">#</a> Сериализация/десериализация форм</h4><p><a href="https://api.jquery.com/serialize/" target="_blank" rel="noopener noreferrer"><code>$('#selector').serialize()</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> — формирует строку запроса из jQuery-коллекции. Метод сам находит элементы форм в коллекции и выбирает только те элементы, которые по <a href="https://www.w3.org/TR/html401/interact/forms.html#h-17.13.2" target="_blank" rel="noopener noreferrer">спецификации<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> считаются пригодными для сабмита (пустые селекты, невыделенные кнопки и радиобаттоны, элементы без имени игнорируются).</p><p>Есть и обратный процесс — десериализация. Ее jQuery из коробки не делает, но есть <a href="https://github.com/kflorence/jquery-deserialize" target="_blank" rel="noopener noreferrer">хороший плагин<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>. Десериализация может быть полезна, когда мы заходим по урлу и надо взять оттуда гет-параметры и вставить их в форму. Например, в форму поиска.</p><p><a href="https://api.jquery.com/serializeArray/" target="_blank" rel="noopener noreferrer"><code>serializeArray()</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> вместо строки запроса вернет сериализованные данные в виде массива объектов <code>[{name:value}, ...]</code>.</p><h3 id="_10-2-2-loading-dynamic-html-fragments"><a href="#_10-2-2-loading-dynamic-html-fragments" aria-hidden="true" class="header-anchor">#</a> 10.2.2 Loading dynamic HTML fragments</h3><p><a href="https://github.com/AurelioDeRosa/jquery-in-action/blob/master/chapter-10/phase.1.html" target="_blank" rel="noopener noreferrer">Пример <code>chapter-10/phase.1.html</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> с загрузкой куска HTML в репозитории книги.</p><h2 id="_10-3-making-get-and-post-requests"><a href="#_10-3-making-get-and-post-requests" aria-hidden="true" class="header-anchor">#</a> 10.3 Making GET and POST requests</h2><p>В основном используются GET и POST запросы:</p><ul><li><code>GET</code> — когда операция ничего не меняет. Каждый раз придет одно и то же, <a href="http://www.restapitutorial.ru/lessons/idempotency.html" target="_blank" rel="noopener noreferrer">идемпотентность<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>. Браузеры кешируют гет-запросы.</li><li><code>POST</code> — когда что-то нужно изменить: удалить, записать, отредактировать. Не идемпотентная операция.</li></ul><h3 id="_10-3-1-getting-data-with-get"><a href="#_10-3-1-getting-data-with-get" aria-hidden="true" class="header-anchor">#</a> 10.3.1 Getting data with GET</h3><p><code>$.get(url[, data][, callback][, dataType])</code> — пошлет гет-запрос при <code>data</code> в любом виде (в отличие от <code>load</code>, который посылает POST, если отдать массив/объект). <code>dataType</code> говорит, как нужно интерпретировать ответ: html, text, xml, json, script или jsonp. Вернет <code>jqXHR</code> инстанс.</p><p>Никуда ничего не вставит, нужно самим вставлять ответ в DOM в колбэке, если нужно.</p><p>В jQuery 3.x добавилась новая сигнатура: <code>$.get([options])</code>.</p><h3 id="_10-3-2-getting-json-data"><a href="#_10-3-2-getting-json-data" aria-hidden="true" class="header-anchor">#</a> 10.3.2 Getting JSON data</h3><p><code>$.getJSON()</code> — для случаев, когда известно, что придет JSON. Сама распарсит и сделает его JS-данными в колбэке.</p><p>Как если бы послали <code>$.get()</code> с <code>dataType</code><code>json</code>.</p><h3 id="_10-3-3-dynamically-loading-script"><a href="#_10-3-3-dynamically-loading-script" aria-hidden="true" class="header-anchor">#</a> 10.3.3 Dynamically loading script</h3><p><code>$.getScript()</code> — когда нужно динамически подгрузить скрипт и вставить его на страницу. Тут URL не обязательно должен быть с того же домена. Под капотом так:</p><div class="language-js extra-class"><pre class="language-js"><code>getScript<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span> url<span class="token punctuation">,</span> callback <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> jQuery<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span> url<span class="token punctuation">,</span> undefined<span class="token punctuation">,</span> callback<span class="token punctuation">,</span> <span class="token string">&quot;script&quot;</span> <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// без `data`, `dataType` указан как `script`</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Скрипт загружается, исполняется и переменные/функции становятся доступны.</p><h3 id="_10-3-4-making-post-requests"><a href="#_10-3-4-making-post-requests" aria-hidden="true" class="header-anchor">#</a> 10.3.4 Making POST requests</h3><p>Когда POST:</p><ul><li>Нужно изменить данные, а не просто получить</li><li>Нужно отправить много байтов (картинку)</li><li>Сервер реагирует по-разному на GET и POST</li><li>...</li></ul><p><code>$.post()</code> — как гет, только передает данные постом.</p><h3 id="_10-3-5-implementing-cascading-dropdowns"><a href="#_10-3-5-implementing-cascading-dropdowns" aria-hidden="true" class="header-anchor">#</a> 10.3.5 Implementing cascading dropdowns</h3><p>Интересно про отлавливание события на родительском элементе при всплытии.</p><p>Есть 3 селекта. На изменение каждого нужно выполнять какое-то действие. Как это лучше сделать? Можно использовать то, что событие всплывает и навесить <code>change</code> на элемент, в котором эти 3 селекта находятся. Будет всплытие и там все сделается. См. страницу 287 в книге.</p><p>Пример. На изменение нужно <code>&lt;option value=&quot;&quot;&gt;-choodse smth-&lt;/option&gt;</code> — пустое <code>value</code> с текстом заглушкой. Вешаем обработчик на родительский див:</p><div class="language-js extra-class"><pre class="language-js"><code><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#selections-pane'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">change</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">{</span>
   <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'[value=&quot;&quot;]'</span><span class="token punctuation">,</span> event<span class="token punctuation">.</span>target<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// среди всех дочерних селектов найти пустые опшены</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="_10-4-taking-full-control-of-an-ajax-request"><a href="#_10-4-taking-full-control-of-an-ajax-request" aria-hidden="true" class="header-anchor">#</a> 10.4 Taking full control of an Ajax request</h2><p>Когда может быть плезен <code>$.ajax</code>:</p><ul><li>Сказать серверу, что не нужно отдавать из кэша браузера</li><li>Можно послать запрос и ждать ответ только определенное время</li><li>Если получили ответ в одном формате (текст, например), но хотим с ним работать как с html или xml.</li><li>...</li></ul><h3 id="_10-4-1-making-ajax-requests-with-all-the-trimmings"><a href="#_10-4-1-making-ajax-requests-with-all-the-trimmings" aria-hidden="true" class="header-anchor">#</a> 10.4.1 Making Ajax requests with all the trimmings</h3><p><code>$.ajax(url[, options])</code>, <code>$.ajax([options])</code> — <code>url</code> можно указывать отдельно, а можно прямо в опциях. Возвращает <code>jqXHR</code>-объект.</p><p><code>dataType</code> — тип данных, которые мы ожидаем получить. Определяет, надо ли как-то обработать полученные данные перед передачей в колбэк.</p><p><code>context</code> — задать <code>this</code> для функции-обработчика. По-умолчанию — объект опций.</p><p><a href="http://api.jquery.com/jQuery.ajax/" target="_blank" rel="noopener noreferrer">Полный список опций<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>. Страница 290 в книге.</p><h3 id="_10-4-2-setting-request-defaults"><a href="#_10-4-2-setting-request-defaults" aria-hidden="true" class="header-anchor">#</a> 10.4.2 Setting request defaults</h3><p><code>$.ajaxSetup()</code> — установить опции всех аяксовых запросов из jQuery по умолчанию. Не для установки обработчиков для done, error, always. Не действует на <code>.load()</code>, не переопределяет методы для <code>$.get</code> и <code>$.post</code>.</p><p>Свойства по умолчанию можно переопределять в конкретных вызовах.</p><h3 id="_10-4-3-handling-ajax-events"><a href="#_10-4-3-handling-ajax-events" aria-hidden="true" class="header-anchor">#</a> 10.4.3 Handling Ajax events</h3><p>Есть ряд кастомных событий, с помощью которых можно обрабатывать аяксовые запросы.</p><ul><li>Локальные: <code>beforeSend</code>, <code>done</code>, <code>fail</code>, <code>alway</code> — обрабатываются колбэками. Это колбэки в конкретных вызовах <code>$.ajax</code>.</li><li><a href="https://api.jquery.com/category/ajax/global-ajax-event-handlers/" target="_blank" rel="noopener noreferrer">Глобальные<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>: события для всех аяксовых запросов: <code>ajaxStart</code>, <code>ajaxSend</code>, <code>ajaxSuccess</code>, <code>ajaxError</code>, <code>ajaxStop</code> и <code>ajaxComplete</code>. Это кастомные события, которые триггерятся на <code>document</code> и на них можно подписаться и обработать.</li></ul><p>Глобальные события вешаются на <code>document</code>, как обычные события: <code>$(document).on('ajaxStart)</code>.</p><p>Помимо навешивания обработчиков на события <code>document</code>, есть интерфейс через функции:</p><div class="language- extra-class"><pre class="language-text"><code>ajaxComplete(callback)
ajaxError(callback)
ajaxSend(callback)
ajaxStart(callback)
ajaxStop(callback)
ajaxSuccess(callback)
</code></pre></div><p>jQuery отслеживает количество активных запросов (<code>jQuery.active</code>). Так, если запустить пачку аяксов, то <code>ajaxStart</code> и <code>ajaxStop</code> не сработают для каждого, а будут до и после передачи данных. См. пример в <code>book-repo/chapter-10/ajax.events.html</code> и код jQuery 3.0 в строках <code>9027</code> и <code>9262</code></p><h3 id="_10-4-4-advanced-ajax-utility-functions"><a href="#_10-4-4-advanced-ajax-utility-functions" aria-hidden="true" class="header-anchor">#</a> 10.4.4 Advanced Ajax utility functions</h3><p>Продвинутые методы, редко понадобятся, но они есть.</p><p><code>$.ajaxPrefilter([dataTypes,] callback)</code> — позволяет обработать аяксовые опции перед отправкой. Можно зарубить запрос, можно перенаправить, изменить дата <code>dataType</code>. См. пример в <code>book-repo/chapter-10/$.ajaxPrefilter.html</code>.</p><p><code>$.ajaxTransport([dataType,] callback)</code> — позволяет изменить внутреннюю кухню <code>$.ajax</code>. Должен вернуть объект с методами <code>send</code> и <code>abort</code> (внутренний транспортный объект jQuery). Каждый запрос имеет свой собственный транспортный объект, поэтому напрямую мы его вернуть не можем, можем только подменить методы. Использовать нужно в случае крайней необходимости.</p><h2 id="вопросы-и-задания"><a href="#вопросы-и-задания" aria-hidden="true" class="header-anchor">#</a> Вопросы и задания</h2><h3 id="прочитать-и-попробовать"><a href="#прочитать-и-попробовать" aria-hidden="true" class="header-anchor">#</a> Прочитать и попробовать</h3><ul><li><a href="https://learn.javascript.ru/ajax-jsonp" target="_blank" rel="noopener noreferrer">JSONP<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li><a href="https://en.wikipedia.org/wiki/Same-origin_policy" target="_blank" rel="noopener noreferrer">Same origin policy<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li><a href="https://medium.com/statuscode/cors-a-guided-tour-4e72230a8739" target="_blank" rel="noopener noreferrer">CORS<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li><a href="https://learn.javascript.ru/fetch" target="_blank" rel="noopener noreferrer"><code>fetch</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</li></ul><h3 id="задача"><a href="#задача" aria-hidden="true" class="header-anchor">#</a> Задача</h3><p>Реализовать <a href="https://github.com/amiskov/homeworks/tree/master/city-selector" target="_blank" rel="noopener noreferrer">компонент с выбором региона и города<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p></div><div class="content edit-link"><!----><!----></div><div class="content page-nav"><p class="inner"><span class="prev">
        ← <a href="/jquery-handbook/ch05/" class="prev">
          5 Bringing pages to life with jQuery
        </a></span><span class="next"><a href="/jquery-handbook/ch11/">
          11 Demo: an Ajax-powered contact form
        </a> →
      </span></p></div></div></div></div>
    <script src="/jquery-handbook/assets/js/3.b1b10936.js" defer></script><script src="/jquery-handbook/assets/js/app.c2cea729.js" defer></script>
  </body>
</html>
